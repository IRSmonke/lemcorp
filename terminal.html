<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LemCorp Dev Terminal</title>
<style>
  body {
    background: black;
    color: #33ff33;
    font-family: monospace;
    margin: 0; padding: 20px;
    height: 100vh;
    overflow: hidden;
  }
  #terminal {
    white-space: pre-wrap;
    max-height: 80vh;
    overflow-y: auto;
    border: 2px solid #33ff33;
    padding: 20px;
    background: #000;
    font-size: 22px;
    line-height: 1.4;
  }
  #commandInput {
    margin-top: 15px;
    width: 100%;
    padding: 15px;
    background: black;
    color: #33ff33;
    border: 2px solid #33ff33;
    font-family: monospace;
    font-size: 22px;
  }
  .hidden {
    display: none;
  }
  .error {
    color: #ff3333;
  }
  .critical {
    color: #ff0000;
    font-weight: bold;
  }
  .glitch {
    color: #ff00ff;
    text-shadow:
      0 0 5px #ff00ff,
      0 0 10px #ff00ff,
      0 0 20px #ff00ff;
  }
  .progress-bar {
    font-family: monospace;
  }
</style>
</head>
<body>

<div id="terminal">LEM-CORP SYSTEM TERMINAL v1.0<br>&gt; Awaiting command...<br>&gt; </div>
<input id="commandInput" type="text" autocomplete="off" placeholder="Enter command..." />

<script>
  const terminal = document.getElementById("terminal");
  const input = document.getElementById("commandInput");

  const shutdownCommand = "shutdown";
  let attempts = 3;

  // Fake file system structure
  const fileSystem = {
    "/": ["secret", "logs", "config.txt"],
    "/secret": ["protocol.txt", "experiment.md"],
    "/logs": ["error.log", "activity.log"],
  };
  const filesContent = {
    "/config.txt": "LemCorp Prototype Terminal Config\nVersion 1.0\nDebug Mode: OFF",
    "/secret/protocol.txt": "Protocol 63D Override - Level 4 Clearance Required\nNo further access permitted.",
    "/secret/experiment.md": "Subject 63D shows increased neural activity...\nRecommendation: Continue monitoring.",
    "/logs/error.log": "2025-06-14 08:15 - ERROR - Neural link unstable.\n2025-06-14 09:00 - WARNING - Unauthorized access attempt detected.",
    "/logs/activity.log": "2025-06-14 07:00 - System boot.\n2025-06-14 08:00 - Prototype initialized.",
  };

  let currentPath = "/";

  // Secret Easter Eggs
  const secretCommands = {
    "reveal": "Access Level: Classified\nYou found hidden LemCorp archives.",
    "protocol-x": "Protocol X active.\nSubject 63D containment compromised.",
    "accesskey": "Access key validated.\nOverride commands enabled."
  };

  input.focus();

  function appendLine(text, className = "") {
    const line = document.createElement("div");
    line.innerHTML = text;
    if (className) line.classList.add(className);
    terminal.appendChild(line);
    terminal.scrollTop = terminal.scrollHeight;
  }

  function glitchLine(text, duration = 1000) {
    const line = document.createElement("div");
    line.textContent = text;
    line.classList.add("glitch");
    terminal.appendChild(line);
    terminal.scrollTop = terminal.scrollHeight;
    setTimeout(() => {
      line.classList.remove("glitch");
    }, duration);
  }

  function typeOutLine(text, className = "", speed = 30) {
    return new Promise(resolve => {
      const line = document.createElement("div");
      if (className) line.classList.add(className);
      terminal.appendChild(line);
      terminal.scrollTop = terminal.scrollHeight;

      let i = 0;
      function typeChar() {
        if (i < text.length) {
          line.innerHTML += text.charAt(i) === " " ? "&nbsp;" : text.charAt(i);
          i++;
          terminal.scrollTop = terminal.scrollHeight;
          setTimeout(typeChar, speed);
        } else {
          resolve();
        }
      }
      typeChar();
    });
  }

  input.addEventListener("keydown", async (e) => {
    if (e.key === "Enter") {
      const cmdRaw = input.value.trim();
      const cmd = cmdRaw.toLowerCase();
      if (!cmdRaw) return;

      appendLine("&gt; " + cmdRaw);

      // Easter eggs first
      if (secretCommands[cmd]) {
        await typeOutLine(secretCommands[cmd]);
        input.value = "";
        return;
      }

      // File system commands
      if (cmd === "ls") {
        const files = fileSystem[currentPath] || [];
        await typeOutLine(files.join("  ") || "(empty directory)");
        input.value = "";
        return;
      }

      if (cmd.startsWith("cd ")) {
        const target = cmdRaw.substring(3).trim();
        let newPath;
        if (target === "..") {
          if (currentPath === "/") {
            await typeOutLine("Already at root directory.", "error");
          } else {
            const parts = currentPath.split("/").filter(Boolean);
            parts.pop();
            newPath = "/" + parts.join("/");
            if (newPath === "") newPath = "/";
            currentPath = newPath;
          }
        } else {
          newPath = currentPath === "/" ? `/${target}` : `${currentPath}/${target}`;
          if (fileSystem[newPath]) {
            currentPath = newPath;
          } else {
            await typeOutLine(`Directory not found: ${target}`, "error");
          }
        }
        await typeOutLine(`Current directory: ${currentPath}`);
        input.value = "";
        return;
      }

      if (cmd.startsWith("cat ")) {
        const fileName = cmdRaw.substring(4).trim();
        const fullPath = currentPath === "/" ? `/${fileName}` : `${currentPath}/${fileName}`;
        if (filesContent[fullPath]) {
          const contentLines = filesContent[fullPath].split("\n");
          for (const line of contentLines) {
            await typeOutLine(line);
          }
        } else {
          await typeOutLine(`File not found: ${fileName}`, "error");
        }
        input.value = "";
        return;
      }

      // Shutdown command
      if (cmd === shutdownCommand) {
        await typeOutLine("Shutdown command accepted. Starting shutdown...");
        input.value = "";
        input.disabled = true;
        input.classList.add("hidden");
        runShutdownSequence();
        return;
      }

      // Unknown command handling with attempts and glitch effect
      attempts--;
      glitchLine(`Unknown command: "${cmdRaw}". Attempts left: ${attempts}`, 1500);
      input.value = "";
      if (attempts <= 0) {
        appendLine("SYSTEM LOCKED. TOO MANY FAILED COMMANDS.", "critical");
        input.disabled = true;
        input.classList.add("hidden");
      }
    }
  });

  async function runShutdownSequence() {
    // Progress bar function
    function progressBar(percent) {
      const total = 30;
      const filledLength = Math.floor((percent / 100) * total);
      return "[" + "█".repeat(filledLength) + " ".repeat(total - filledLength) + `] ${percent}%`;
    }

    const steps = [
      "Initiating shutdown sequence...",
      "Disconnecting prototype neural link...",
      "Terminating visual cortex simulation...",
      "Freezing sensor loops...",
      "Memory Bank Ω: PURGED",
      "Disconnecting remote monitor...",
      "Disabling hibernation fallback...",
      "Subject 63D: RELEASED",
      "Revoking LemCorp firewall lock...",
      "Server core temperature: RISING",
      "CRITICAL: EMERGENCY OVERRIDE DETECTED",
      "SYSTEM INTEGRITY: COLLAPSING",
      "Finalizing shutdown...",
      "TERMINATING LOCAL USER...",
      "CONNECTION STABLE: FALSE",
      "FADING SIGNAL...",
      "SYSTEM OFFLINE"
    ];

    for (let i = 0; i < steps.length; i++) {
      await typeOutLine("&gt; " + steps[i], i >= 10 ? "critical" : "");
      if (i === 4 || i === 7 || i === 10) { // add progress bar on some steps
        for (let p = 0; p <= 100; p += 20) {
          await typeOutLine(progressBar(p), "progress-bar");
          await new Promise(r => setTimeout(r, 150));
        }
      }
      await new Promise(r => setTimeout(r, 700));
    }

    slowlyFadeToWhite();
  }

  function slowlyFadeToWhite() {
    const fade = document.createElement("div");
    fade.style.position = "fixed";
    fade.style.top = 0;
    fade.style.left = 0;
    fade.style.width = "100vw";
    fade.style.height = "100vh";
    fade.style.backgroundColor = "white";
    fade.style.opacity = 0;
    fade.style.transition = "opacity 10s linear";
    fade.style.zIndex = 1000;
    document.body.appendChild(fade);

    requestAnimationFrame(() => {
      fade.style.opacity = 1;
    });

    setTimeout(() => {
      const msg = document.createElement("div");
      msg.textContent = "[ SYSTEM LOCKED. YOU WERE NEVER SUPPOSED TO SEE THIS. ]";
      msg.style.position = "fixed";
      msg.style.top = "50%";
      msg.style.left = "50%";
      msg.style.transform = "translate(-50%, -50%)";
      msg.style.color = "#ff0000";
      msg.style.fontFamily = "monospace";
      msg.style.fontSize = "28px";
      msg.style.backgroundColor = "black";
      msg.style.padding = "20px 40px";
      msg.style.border = "2px solid #ff0000";
      msg.style.borderRadius = "8px";
      msg.style.zIndex = 1100;
      msg.style.textAlign = "center";
      document.body.appendChild(msg);
    }, 10000);
  }
</script>

</body>
</html>
